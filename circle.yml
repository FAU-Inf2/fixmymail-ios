machine:
  xcode:
    version: "6.3.1"
  environment:
    LC_CTYPE: en_US.UTF-8
    XCODE_SCHEME: FixMyMail
    XCODE_PROJECT: FixMyMail.xcodeproj
    DEVELOPER_NAME: 'iPhone Developer: Mobile Application Development (VNDLKSAU2T)'
    APPNAME: CircleCI-Sample
    PROFILE_UUID: cf6e9333-673e-4ec5-8813-fa4272594487

dependencies:
  override:
    - uname -a
    - brew update
    - ./scripts/add-key.sh
    - brew install carthage
    - mkdir -p Carthage/Checkouts
    - git clone https://github.com/MailCore/mailcore2 Carthage/Checkouts/mailcore2
    - git clone https://github.com/SwiftyJSON/SwiftyJSON.git Carthage/Checkouts/SwiftyJSON
    - git clone https://github.com/matthewpalmer/Locksmith
    - cd Carthage/Checkouts/SwiftyJSON && git checkout tags/2.2.0 && cd ../../..
    - carthage update --verbose --platform all
    - carthage build --verbose --platform all --configuration Release
deployment:
  mad:
    branch: master
    commands:
      - ./scripts/deploy.sh
      - ./scripts/remove-key.sh
